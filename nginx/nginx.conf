events {}

http {
    upstream unjudol_app {
        server unjudol-app:8000;  # docker-compose service name
    }

    server {
        listen 80;
        server_name www.unjudol.com unjudol.com;

        # Redirect plain HTTP to HTTPS (optional, if you set up SSL later)
        # return 301 https://$host$request_uri;

        location / {
            proxy_pass         http://unjudol_app;
            proxy_http_version 1.1;

            proxy_set_header   Host              $host;
            proxy_set_header   X-Real-IP         $remote_addr;
            proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;
            proxy_set_header   X-Forwarded-Proto $scheme;
        }

        # Optional health endpoint passthrough
        location /health {
            proxy_pass http://unjudol_app/health;
        }

        # Optional: serve static files directly if FastAPI mounts /static
        location /static {
            proxy_pass http://unjudol_app/static;
        }
    }
}
